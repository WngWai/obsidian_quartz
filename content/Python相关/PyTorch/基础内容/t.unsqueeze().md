在PyTorch中，`t.unsqueeze()`函数用于在张量中**插入维度**，即在指定位置上添加尺寸为1的维度。
**方法定义**：
```python
t.unsqueeze(dim)
```
**参数**：
- `dim`（整数）：指定要插入维度的位置。
**返回值**：
`unsqueeze()`方法返回一个新的张量，其中在指定位置上添加了尺寸为1的维度。
![[Pasted image 20231025195313.png]]
**注意**：
- `unsqueeze()`方法不会改变原始张量的形状，而是返回一个具有添加尺寸为1的维度的新张量。
- 插入的维度索引可以是负数，表示从末尾开始的位置。

**示例**：
以下是使用`unsqueeze()`方法的示例：

```python
import torch

# 创建一个2维张量
t1 = torch.tensor([[1, 2, 3], [4, 5, 6]])

# 在维度0插入尺寸为1的维度
t2 = t1.unsqueeze(0)
print(t2.shape)  # 输出: torch.Size([1, 2, 3])

# 在维度1插入尺寸为1的维度
t3 = t1.unsqueeze(1)
print(t3.shape)  # 输出: torch.Size([2, 1, 3])

# 在维度-1（最后一个维度）插入尺寸为1的维度
t4 = t1.unsqueeze(-1)
print(t4.shape)  # 输出: torch.Size([2, 3, 1])
```

在上述示例中，我们创建了一个2维张量 `t1`，其形状为 `(2, 3)`。

然后，我们使用`unsqueeze()`方法在不同的位置插入尺寸为1的维度。

对于张量 `t1`，我们使用`unsqueeze(0)`在维度0的位置插入尺寸为1的维度，结果是一个新的张量 `t2`，其形状为 `(1, 2, 3)`。

同样地，我们使用`unsqueeze(1)`在维度1的位置插入尺寸为1的维度，得到新的张量 `t3`，其形状为 `(2, 1, 3)`。

我们还可以使用负数索引，例如`unsqueeze(-1)`，表示在最后一个维度插入尺寸为1的维度。结果是一个新的张量 `t4`，其形状为 `(2, 3, 1)`。

`unsqueeze()`方法对于在指定位置插入尺寸为1的维度非常有用，特别是在进行广播操作或与具有不同形状的张量进行计算时。