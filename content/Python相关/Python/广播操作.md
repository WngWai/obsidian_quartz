广播操作是指在进行元素级别的计算时，若两个数据结构的形状不完全相同，但是可以通过自动扩展（广播）**操作使它们具有相同的形状**，从而进行计算。

![[Pasted image 20231221111136.png]]
```python
tensor([[0., 0., 0.],
		[0., 0., 0.]])
		+
tensor([1., 1., 1.])
		=
tensor([[1., 1., 1.],
		[1., 1., 1.]])
```


在 Pandas 中，广播操作是**默认启用**的，可以在对 DataFrame 或 Series 进行**数学计算时自动进行扩展**。广播操作的规则如下：

1. 如果两个数据结构的**维度完全相同**，则直接进行元素级别的计算。
2. 如果两个数据结构的**维度不同**，但**至少一个维度的长度为1**，则可以进行自动扩展。
```python
[[0],
 [1],
 [2]]

[[0, 1]]
通过广播机制进行扩展：
[[0, 0],
 [1, 1],
 [2, 2]]
由3行1列扩展为3行2列
[[0, 1],
 [0, 1],
 [0, 1]]
由1行2列扩展为3行2列
```



3.  如果两个数据结构的维度不同，并且**没有长度为1**的维度，则会抛出 ValueError 异常。

以下是一个示例来说明广播操作的使用：

```python
import pandas as pd

data = {'A': [1, 2, 3],
        'B': [4, 5, 6]}
df = pd.DataFrame(data)

# 对 DataFrame 进行减法操作
result = df.sub(1)
print(result)
```

输出结果为：

```python
   A  B
0  0  3
1  1  4
2  2  5
```

在上面的示例中，我们将 DataFrame `df` 的每个元素减去了 1。由于 1 可以被广播成与 `df` 相同形状的 DataFrame，因此广播操作成功实现了减法。

与 DataFrame 类似，Series 也支持广播操作。以下是一个示例：

```python
import pandas as pd

data = [1, 2, 3, 4, 5]
s = pd.Series(data)

# 对 Series 进行除法操作
result = s.div(2)
print(result)
```

输出结果为：
```python
0    0.5
1    1.0
2    1.5
3    2.0
4    2.5
dtype: float64
```

在上面的示例中，我们将 Series `s` 的每个元素除以了 2。由于 2 可以被广播成与 `s` 相同长度的 Series，因此广播操作成功实现了除法。
