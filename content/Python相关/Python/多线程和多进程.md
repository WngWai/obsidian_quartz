Python中的多线程和多进程是并发编程的两种主要方式，它们用于提高程序的执行效率，特别是在处理I/O密集型任务或需要并行执行的任务时。尽管二者都旨在实现并发，但它们的工作机制、优缺点和适用场景有所不同。

线程和进程的区别是什么？ - biaodianfu的回答 - 知乎
https://www.zhihu.com/question/25532384/answer/411179772

进程>>线程！



### 1. 多线程（Multithreading）

**定义**：多线程是在**同一个进程内创建多个线程**，每个线程共享进程的内存空间和资源。

**特点**：
- **共享内存空间**：所有线程共享同一块内存空间，这使得线程之间的数据共享和通信变得简单。
- **轻量级**：线程是轻量级的，创建和销毁的开销较小。
- **并发执行**：适用于I/O密集型任务，如文件读写、网络请求等。

**缺点**：
- **全局解释器锁（GIL）**：Python的GIL限制了同一时间只有一个线程执行Python字节码，导致在CPU密集型任务中，多线程并不能真正并行执行。
- **线程安全**：由于线程共享内存空间，必须小心处理线程安全问题，避免竞争条件和死锁。

**示例**：

```python
import threading
import time

def worker(n):
    print(f"Thread {n} starting")
    time.sleep(2)
    print(f"Thread {n} finishing")

threads = []

for i in range(5):
    t = threading.Thread(target=worker, args=(i,))
    threads.append(t)
    t.start()

for t in threads:
    t.join()
```

### 2. 多进程（Multiprocessing）

**定义**：多进程是在**操作系统层面**创建多个进程，每个进程都有独立的内存空间和资源。

**特点**：
- **独立内存空间**：每个进程有自己独立的内存空间，进程之间的数据互不干扰，安全性更高。
- **真正并行**：多个进程可以在**多核CPU上并行执行**，适用于CPU密集型任务。
- **资源隔离**：进程之间通过进程间通信（IPC）进行数据共享，如管道（pipe）、队列（queue）等。

**缺点**：
- **较高开销**：创建和销毁进程的开销较大，进程间通信相对复杂。
- **数据共享复杂**：由于进程有独立的内存空间，数据共享比线程复杂，需要使用IPC机制。

**示例**：

```python
import multiprocessing
import time

def worker(n):
    print(f"Process {n} starting")
    time.sleep(2)
    print(f"Process {n} finishing")

processes = []

for i in range(5):
    p = multiprocessing.Process(target=worker, args=(i,))
    processes.append(p)
    p.start()

for p in processes:
    p.join()
```

### 3. 多线程和多进程的对比

| 特性                 | 多线程                            | 多进程                            |
|----------------------|-----------------------------------|-----------------------------------|
| 内存共享             | 共享内存空间                      | 独立内存空间                      |
| 创建销毁开销         | 小                                | 大                                |
| 并行执行             | 受GIL限制，适用于I/O密集型任务    | 真正并行，适用于CPU密集型任务     |
| 线程/进程间通信      | 直接通过共享变量                  | 需要IPC机制（管道、队列等）       |
| 数据共享和安全性     | 共享数据访问简单，但需处理线程安全| 数据独立，安全性高，共享复杂      |
| 适用场景             | I/O密集型任务，如文件读写、网络请求| CPU密集型任务，如计算密集型任务   |

### 4. 选择指南

- **I/O密集型任务**：如网络请求、文件读写等，推荐使用多线程，因为线程较轻量，切换开销较小，能有效利用等待时间。
- **CPU密集型任务**：如大规模计算、数据处理等，推荐使用多进程，因为多进程能在多核CPU上并行执行，突破GIL的限制。

### 小结

多线程和多进程各有优缺点，选择合适的并发方式需要根据具体的任务类型和应用场景。理解二者的工作机制和使用场景，可以更好地编写高效、稳定的并发程序。